<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chakaezba Space</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --glass: rgba(255, 255, 255, 0.1); --blur: blur(25px); --accent: #ffffff; }
        body { margin: 0; min-height: 100vh; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto; background: linear-gradient(135deg, #0f0c29, #302b63, #24243e); display: flex; align-items: center; justify-content: center; color: white; overflow-x: hidden; }
        .main-layout { display: flex; align-items: center; justify-content: center; gap: 20px; height: 580px; transition: all 0.8s ease; width: 95%; max-width: 1200px; }
        .glass-panel { background: var(--glass); backdrop-filter: var(--blur); -webkit-backdrop-filter: var(--blur); border: 1px solid rgba(255,255,255,0.15); border-radius: 32px; padding: 40px 25px 25px 25px; box-shadow: 0 10px 40px rgba(0,0,0,0.4); display: flex; flex-direction: column; align-items: center; transition: all 0.6s ease; box-sizing: border-box; position: relative; }
        .panel-label { position: absolute; top: 15px; left: 20px; font-size: 10px; text-transform: uppercase; letter-spacing: 2px; opacity: 0.4; font-weight: 600; pointer-events: none; }
        #player-card { width: 380px; height: 100%; display: none; opacity: 0; transform: translateX(50px) scale(0.9); pointer-events: none; }
        #player-card.visible { display: flex; animation: slideIn 0.8s forwards cubic-bezier(0.175, 0.885, 0.32, 1.275); pointer-events: auto; }
        @keyframes slideIn { to { opacity: 1; transform: translateX(0) scale(1); } }
        #profile-card { width: 280px; height: 100%; justify-content: flex-start; }
        #track-card { width: 130px; height: 100%; overflow-y: auto; }
        .profile-avatar { width: 140px; height: 140px; border-radius: 50%; background: url('https://i.pinimg.com/originals/2d/e8/3b/2de83b28f80424566c7e52292f750b2c.gif') center/cover; margin-top: 10px; margin-bottom: 20px; border: 3px solid rgba(255,255,255,0.1); }
        .profile-desc { font-size: 13px; text-align: center; line-height: 1.6; opacity: 0.7; margin-top: 15px; max-width: 90%; font-weight: 300; }
        .social-icons { display: flex; gap: 25px; margin-top: auto; padding-bottom: 10px; }
        .social-icons a { color: white; font-size: 28px; opacity: 0.7; transition: 0.3s; text-decoration: none; }
        .social-icons a:hover { opacity: 1; transform: translateY(-3px); }
        .main-cover { width: 100%; aspect-ratio: 1/1; border-radius: 20px; object-fit: cover; box-shadow: 0 10px 30px rgba(0,0,0,0.5); margin-bottom: 20px; }
        .info h2 { margin: 0 0 20px 0; font-size: 18px; text-align: center; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; width: 100%; }
        .progress-container { width: 100%; height: 6px; background: rgba(255,255,255,0.1); border-radius: 10px; cursor: pointer; margin-bottom: 25px; }
        .progress-bar { height: 100%; background: var(--accent); width: 0%; border-radius: 10px; }
        .controls-wrapper { display: flex; flex-direction: column; align-items: center; width: 100%; gap: 20px; }
        .player-btns { display: flex; justify-content: center; align-items: center; gap: 20px; }
        .nav-btn { width: 40px; height: 40px; border-radius: 50%; background: rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.3s; font-size: 14px; }
        .nav-btn:hover { background: rgba(255,255,255,0.2); transform: scale(1.1); }
        .play-btn { width: 60px; height: 60px; background: white; color: black; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 22px; cursor: pointer; transition: 0.3s; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .play-btn:hover { transform: scale(1.1); box-shadow: 0 0 25px rgba(255,255,255,0.3); }
        .volume-slider { -webkit-appearance: none; width: 100px; height: 4px; background: rgba(255,255,255,0.2); border-radius: 5px; outline: none; }
        .volume-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 12px; height: 12px; background: white; border-radius: 50%; cursor: pointer; }
        .track-mini-item { width: 80px; height: 80px; margin-bottom: 15px; cursor: pointer; transition: 0.4s ease; }
        .track-mini-item img { width: 100%; height: 100%; border-radius: 20px; object-fit: cover; opacity: 0.4; border: 2px solid transparent; transition: 0.3s; }
        .track-mini-item.active img { opacity: 1; border-color: white; transform: scale(1.1); }
        ::-webkit-scrollbar { width: 0px; }

        @media (max-width: 900px) {
            body { overflow-y: auto; align-items: flex-start; padding: 20px 0; }
            .main-layout { flex-direction: column; height: auto; gap: 15px; }
            #profile-card { width: 90%; height: auto; order: 1; padding-bottom: 40px; }
            #player-card { width: 90%; height: auto; order: 2; transform: none; }
            #track-card { width: 90%; height: auto; order: 3; overflow-y: visible; }
            #list { display: flex; overflow-x: auto; width: 100%; gap: 15px; padding: 10px 0; }
            .track-mini-item { flex-shrink: 0; margin-bottom: 0; }
            .social-icons { margin-top: 20px; }
        }
    </style>
</head>
<body>
    <div class="main-layout">
        <div class="glass-panel" id="player-card">
            <div class="panel-label">Music Player</div>
            <img id="cover" src="" class="main-cover">
            <div class="info"><h2 id="title">Выбор трека...</h2></div>
            <div class="progress-container" id="progress-container"><div class="progress-bar" id="progress-bar"></div></div>
            <div class="controls-wrapper">
                <div class="player-btns">
                    <div class="nav-btn" id="prev"><i class="fas fa-step-backward"></i></div>
                    <div class="play-btn" id="play-pause"><i class="fas fa-play" id="play-icon"></i></div>
                    <div class="nav-btn" id="next"><i class="fas fa-step-forward"></i></div>
                </div>
                <div style="display:flex; align-items:center; gap:10px; opacity:0.6">
                    <i class="fas fa-volume-down"></i>
                    <input type="range" class="volume-slider" id="volume" min="0" max="1" step="0.01" value="0.5">
                    <i class="fas fa-volume-up"></i>
                </div>
            </div>
            <audio id="main-audio"></audio>
        </div>
        <div class="glass-panel" id="profile-card">
            <div class="panel-label">About Me</div>
            <div class="profile-avatar"></div>
            <h2 style="margin:0; letter-spacing: 1px;">Chakaezba</h2>
            <div class="profile-desc">Владелец нищего сервера в Minecraft, игрок в osu! и истинный любитель музыки. Ничего не добившийся лох, но зато со вкусом.</div>
            <div class="social-icons">
                <a href="https://t.me/chakaezba" target="_blank"><i class="fab fa-telegram"></i></a>
                <a href="https://steamcommunity.com/id/chakaezba/" target="_blank"><i class="fab fa-steam"></i></a>
            </div>
        </div>
        <div class="glass-panel" id="track-card">
            <div class="panel-label">Tracklist</div>
            <div id="list"></div>
        </div>
    </div>
    <script src="data.js"></script>
    <script>
        const audio = document.getElementById('main-audio');
        const playBtn = document.getElementById('play-pause');
        const playIcon = document.getElementById('play-icon');
        const progressBar = document.getElementById('progress-bar');
        const progressContainer = document.getElementById('progress-container');
        const volumeSlider = document.getElementById('volume');
        const list = document.getElementById('list');
        const cover = document.getElementById('cover');
        const title = document.getElementById('title');
        const playerCard = document.getElementById('player-card');
        let isFirstPlay = true; let currentIdx = -1;
        function b64toBlob(b64) {
            const bin = atob(b64); const array = new Uint8Array(bin.length);
            for (let i = 0; i < bin.length; i++) array[i] = bin.charCodeAt(i);
            return URL.createObjectURL(new Blob([array], {type: 'audio/mpeg'}));
        }
        function loadTrack(index, playImmediate = false) {
            if (index < 0) return;
            if (isFirstPlay && playImmediate) {
                playerCard.style.display = 'flex';
                setTimeout(() => playerCard.classList.add('visible'), 10);
                isFirstPlay = false;
            }
            currentIdx = index; const t = myTracks[index];
            const items = document.querySelectorAll('.track-mini-item');
            items.forEach(i => i.classList.remove('active'));
            if(items[index]) items[index].classList.add('active');
            cover.src = t.cover ? `data:image/png;base64,${t.cover}` : 'https://via.placeholder.com/340';
            title.innerText = t.title; audio.src = b64toBlob(t.audio);
            if (playImmediate) playTrack();
        }
        function playTrack() { audio.play(); playIcon.classList.replace('fa-play', 'fa-pause'); }
        function pauseTrack() { audio.pause(); playIcon.classList.replace('fa-pause', 'fa-play'); }
        playBtn.addEventListener('click', () => audio.paused ? playTrack() : pauseTrack());
        volumeSlider.addEventListener('input', (e) => audio.volume = e.target.value);
        audio.addEventListener('timeupdate', () => { if (!isNaN(audio.duration)) progressBar.style.width = (audio.currentTime / audio.duration) * 100 + '%'; });
        progressContainer.addEventListener('click', (e) => { if (!isNaN(audio.duration)) audio.currentTime = (e.offsetX / progressContainer.clientWidth) * audio.duration; });
        document.getElementById('next').addEventListener('click', () => { loadTrack((currentIdx + 1) % myTracks.length, true); });
        document.getElementById('prev').addEventListener('click', () => { loadTrack((currentIdx - 1 + myTracks.length) % myTracks.length, true); });
        audio.addEventListener('ended', () => document.getElementById('next').click());
        if (typeof myTracks !== 'undefined' && myTracks.length > 0) {
            myTracks.forEach((t, i) => {
                const div = document.createElement('div'); div.className = 'track-mini-item';
                div.innerHTML = `<img src="${t.cover ? 'data:image/png;base64,'+t.cover : 'https://via.placeholder.com/80'}">`;
                div.onclick = () => loadTrack(i, true); list.appendChild(div);
            });
        }
    </script>
</body>
</html>